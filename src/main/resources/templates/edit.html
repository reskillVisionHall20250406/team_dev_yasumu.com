<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>ä¼šå“¡æƒ…å ±å¤‰æ›´</title>
	<link rel="stylesheet" type="text/css" href="/css/tachiki.css">
</head>

<body>
		<span th:replace="header2">
	</span>

	<div class="login-container">
		<div class="form-group">
        <h2>ä¼šå“¡æƒ…å ±å¤‰æ›´</h2>
		
		<img class="mypage-image"
		     th:if="${customers.image != null and !#strings.isEmpty(customers.image) and customers.image != 'null'}"
		     th:src="@{${customers.image}}"
		     alt="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ" />
		<form action="/mypage/edit" class="edit-form" method="post" enctype="multipart/form-data">
				<input type="text" name="name" th:value="${customers.name}" placeholder="*åå‰"><br>
			<input type="email" name="email" th:value="${customers.email}" placeholder="*ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹"><br>
			<input type="text" name="address" th:value="${customers.address}" placeholder="*ä½æ‰€"><br>
			<input type="text" name="tel" th:value="${customers.tel}" placeholder="*é›»è©±ç•ªå·" maxlength="11" oninput="this.value=this.value.replace(/[^0-9]/g,'');"><br>
		<div class="form-group" style="position: relative;">
            <input type="password" id="password" name="password" minlength="8" placeholder="*ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆåŠè§’è‹±æ•°å­—8æ–‡å­—ä»¥ä¸Šï¼‰">
            <!--  ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ ë²„íŠ¼  -->
            <button type="button" onclick="togglePassword(event)" class="toggle-btn">ğŸ”’</button>

        </div>
			<input type="text" name="cardNo" placeholder="ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æƒ…å ±ç™»éŒ²" maxlength="16" oninput="this.value=this.value.replace(/[^0-9]/g,'');"><br>
			<input type="text" name="code" placeholder="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ¼ãƒ‰" maxlength="3" oninput="this.value=this.value.replace(/[^0-9]/g,'');"><br>
			<input type="text" style="width: 80px;"  name="expiry" id="expiry-month"placeholder="æœˆ"  maxlength="2"  oninput="validateMonth(this)">
			<a>/</a>
			<input type="text" style="width: 80px;" name="expiry" placeholder="å¹´(ä¸‹äºŒæ¡)" maxlength="2" oninput="this.value=this.value.replace(/[^0-9]/g,'');"><br>
			
		    <input name="file" type="file" id="img" class="poi" th:value="${imageUrl}">
	        <button name = "imgBtn" value="imgBtn">ç”»åƒã®è¡¨ç¤º</button><br>
			<a class="edit-commentt">*ã¯å¿…é ˆé …ç›®ã§ã™</a><br>
			<input type="hidden" name="imgname" value="" id="imgname">
			<button class="button-37">é€ä¿¡</button>
			
			
		<ul th:if="${errors}" class="error">
		<li th:each="error : ${errors}" th:text="${error}" class="error"></li>
		</ul>
		</form>
			<div>
		<a href="/mypage">ãƒã‚¤ãƒšãƒ¼ã‚¸ã¸</a>
	</div>
</div>

	<script>

		const pwInput = document.getElementById("password");
			  const warning = document.getElementById("pw-warning");

			  function filterFullWidth(value) {
			    return value.replace(/[^\u0020-\u007E]/g, '');
			  }

			  pwInput.addEventListener("input", function () {
			    const original = this.value;
			    const filtered = filterFullWidth(original);
			    if (original !== filtered) {
			      this.value = filtered;
			      warning.textContent = "å…¨è§’æ–‡å­—ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚åŠè§’è‹±æ•°å­—ã®ã¿å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
			    } else {
			      warning.textContent = "";
			    }
			  });

			 function togglePassword(event) {
                const pwField = document.getElementById("password");
                const btn = event.target;

            if (pwField.type === "password") {
            pwField.type = "text";
            btn.textContent = "ğŸ”“"; // ë³´ì´ê¸° ìƒíƒœ
            } else {
            pwField.type = "password";
            btn.textContent = "ğŸ”’"; // ìˆ¨ê¸°ê¸° ìƒíƒœ
            }
           }


			  pwInput.addEventListener("compositionend", function () {
			    this.value = filterFullWidth(this.value);
			  });
			   function validateMonth(input) {
			    // ìˆ«ì ì™¸ ì œê±°
			    input.value = input.value.replace(/[^0-9]/g, '');

			    // 1ìë¦¬ ìˆ«ìê°€ ì…ë ¥ë˜ë©´ ìë™ìœ¼ë¡œ 0ì„ ì•ì— ë¶™ì—¬ì¤Œ (ë‹¨, 2 ì´ìƒ ì…ë ¥ ì‹œ ì ìš©)
			    if (input.value.length === 1 && parseInt(input.value, 10) > 1) {
			      input.value = '0' + input.value;
			    }

			    // ë‘ ìë¦¬ ìˆ«ìê°€ ì…ë ¥ë˜ì—ˆì„ ê²½ìš° ìœ íš¨ì„± ê²€ì‚¬
			    if (input.value.length === 2) {
			      const num = parseInt(input.value, 10);
			      if (num < 1 || num > 12) {
			        alert("1~12ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
			        input.value = '';
			      }
			    }
			  }
		document.getElementById('img').addEventListener('change', function (event) {
			const file = event.target.files[0]; // æœ€åˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
			if (file) {
				document.getElementById('imgname').value = `/image/${file.name}`;
			} else {
				document.getElementById('imgname').value = 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“';
			}
		});
	</script>

</body>

</html>